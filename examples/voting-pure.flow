type Voter is unique immutable asset address
type ProposalName is unique immutable asset string

type State is {
    chairperson : address,
    voters : list Voter,
    proposals : list { name : ProposalName, voters : list Voter }
}

transaction giveRightToVote(this : State, sender : address, voter : address) -> res : State {
    // Ensure we were called by the chairperson
    [ this.chairperson ] --[ sender ]-> this.chairperson

    new Voter(voter) --> this.voters
    this --> res
}

transaction vote(this : State, sender : address, proposalName : string) -> res : State {
    this.voters[! such that is(sender)] --> this.proposals[! such that hasName(proposalName)].voters
    // Could abbreviate for x[! such that hasField(val)] as x[.field = val] as follows:
    this.voters[! such that = sender] --> this.proposals[.name = proposalName]

    this --> res
}

